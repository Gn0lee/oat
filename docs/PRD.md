# PRD.md

> Product Requirements Document - oat

## TL;DR

- **핵심 가치** - 가족 자산 통합 조회, 자동 시세/환율 반영, 비중 분석
- **MVP 범위** - 인증(이메일/비밀번호), 가구 연결, 거래 기록, 대시보드
- **데이터 입력** - 수동 입력 (증권사 연동 불가)
- **타겟** - 자산을 함께 관리하고 싶은 가족
- **기술 제약** - KIS 마스터파일 기반 종목/시세, 환율 API 일 1회 갱신

---

## 1. 제품 개요

### 1.1 제품명
**oat**

'오트밀'처럼 건강하고 매일 챙겨 먹는(확인하는) 습관을 연상시키며, 발음이 가볍고 기억하기 쉽습니다.

### 1.2 한줄 요약
가족이 각자 운용 중인 투자 자산을 한곳에 모아, "우리 집 전체 자산 현황"을 실시간으로 파악하고 데이터 기반의 자산 배분 의사결정을 돕는 웹 서비스

### 1.3 핵심 가치
| 가치 | 설명 |
|------|------|
| **One View** | 가족 구성원의 자산을 하나의 대시보드에서 통합 조회 |
| **Auto Valuation** | 주가/환율 자동 반영으로 현재 자산 가치 파악 |
| **Smart Decision** | 목표 비중 대비 현재 상태 분석으로 리밸런싱 가이드 |

---

## 2. 타겟 사용자

### 2.1 주요 타겟
- 자산을 공동으로 관리하고 싶은 **가족**
- 각자 증권 계좌를 운용하지만 전체 현황 파악이 어려운 가구
- 엑셀 수기 관리에서 벗어나고 싶은 사람들

### 2.2 사용자 페르소나

**페르소나 A: 김재테크 (35세)**
- 미국 기술주 위주 투자 (애플, 테슬라, 엔비디아)
- 토스증권, 키움증권 사용
- "가족 자산까지 합치면 우리 집 전체 비중이 어떻게 되는지 모르겠어"

**페르소나 B: 이안정 (33세)**
- 국내 배당주, ETF 위주 투자 (삼성전자, KODEX 200)
- 삼성증권 사용
- "전체적으로 괜찮은 건지 확인하고 싶어"

### 2.3 확장 타겟 (향후)
- 부모님 자산까지 함께 관리하고 싶은 가족
- 소규모 투자 모임/클럽

---

## 3. 문제 정의

### 3.1 현재 페인포인트

| 문제 | 상세 |
|------|------|
| **전체 파악 어려움** | "우리 지금 다 합쳐서 얼마야?"에 바로 답하기 어려움 |
| **비중 확인 불가** | 우리 집 전체 포트폴리오의 안전/위험 자산 비율을 모름 |
| **환율 계산 복잡** | 달러/원화 자산 혼재, 현재 환율 기준 총자산 계산 번거로움 |
| **리밸런싱 어려움** | 누가, 어떤 종목을 사야 비율이 맞춰지는지 알기 어려움 |
| **수기 관리 한계** | 엑셀 관리는 실수 가능성, 업데이트 귀찮음 |

### 3.2 해결 방안

| 문제 | 해결책 |
|------|--------|
| 전체 파악 어려움 | 통합 대시보드에서 합산 자산 표시 |
| 비중 확인 불가 | 자산군별/위험도별 비중 차트 제공 |
| 환율 계산 복잡 | 일 1회 환율 자동 갱신, 원화 환산 표시 |
| 리밸런싱 어려움 | 목표 비중 설정 및 현재 상태 비교 기능 |
| 수기 관리 한계 | 종목 검색 + 전일 종가 자동 조회 |

---

## 4. 기능 요구사항

### 4.1 MVP (1단계)

#### 4.1.1 인증
| ID | 기능 | 우선순위 | 설명 |
|----|------|----------|------|
| AUTH-01 | 이메일 회원가입 | 🔴 필수 | 이메일/비밀번호 기반 가입 |
| AUTH-02 | 이메일 인증 | 🔴 필수 | 가입 시 이메일 인증 링크 |
| AUTH-03 | 로그인 | 🔴 필수 | 이메일/비밀번호 로그인 |
| AUTH-04 | 비밀번호 재설정 | 🟡 권장 | 이메일 기반 비밀번호 재설정 |
| AUTH-05 | 로그아웃 | 🔴 필수 | 세션 종료 |

#### 4.1.2 가구 관리
| ID | 기능 | 우선순위 | 설명 |
|----|------|----------|------|
| HH-01 | 가구 생성 | 🔴 필수 | 최초 가입 시 자동 생성 또는 수동 생성 |
| HH-02 | 가구 이름 변경 | 🟢 선택 | "우리집" → 사용자 지정 |
| HH-03 | 초대 코드 생성 | 🔴 필수 | 6자리 코드, 24시간 유효 |
| HH-04 | 초대 수락 | 🔴 필수 | 코드 입력으로 가구 합류 |
| HH-05 | 구성원 목록 | 🔴 필수 | 가구 내 멤버 확인 |

#### 4.1.3 자산 관리
| ID | 기능 | 우선순위 | 설명 |
|----|------|----------|------|
| ASSET-01 | 매수 기록 | 🔴 필수 | 종목 검색 → 수량/단가/거래일 입력 |
| ASSET-02 | 매도 기록 | 🔴 필수 | 보유 종목 선택 → 수량/단가/거래일 입력 |
| ASSET-03 | 거래 내역 | 🔴 필수 | 매수/매도 기록 목록 조회 |
| ASSET-04 | 거래 수정 | 🟡 권장 | 잘못 입력한 거래 수정 |
| ASSET-05 | 거래 삭제 | 🟡 권장 | 잘못 입력한 거래 삭제 |
| ASSET-06 | 보유 현황 | 🔴 필수 | 현재 보유 종목 목록 (정렬/필터링) |
| ASSET-07 | 종목 검색 | 🔴 필수 | 티커/종목명/초성으로 검색 (한국/미국) |
| ASSET-08 | 전일 종가 조회 | 🔴 필수 | stock_master 테이블에서 조회 |
| ASSET-09 | 수동 가격 입력 | 🟡 권장 | 실물 자산, 비상장 주식용 |

#### 4.1.4 종목 설정 관리
| ID | 기능 | 우선순위 | 설명 |
|----|------|----------|------|
| STOCK-01 | 종목 설정 목록 | 🔴 필수 | 가구에 등록된 종목 목록 조회 |
| STOCK-02 | 종목 설정 수정 | 🔴 필수 | 자산유형, 위험도 등 수정 |
| STOCK-03 | 종목 자동 등록 | 🔴 필수 | 첫 거래 시 자동으로 종목 설정 생성 |
| STOCK-04 | 종목 삭제 | 🟢 선택 | 거래 기록 없는 종목만 삭제 가능 |

#### 4.1.5 대시보드
| ID | 기능 | 우선순위 | 설명 |
|----|------|----------|------|
| DASH-01 | 총 자산 표시 | 🔴 필수 | 원화 기준 총 평가금액 |
| DASH-02 | 총 수익률 | 🔴 필수 | (평가금액 - 투자원금) / 투자원금 |
| DASH-03 | 소유자별 자산 | 🔴 필수 | 남편/아내 각각의 자산 및 비중 |
| DASH-04 | 자산군별 비중 | 🔴 필수 | 주식/채권/현금 등 파이차트 |
| DASH-05 | 위험도별 비중 | 🔴 필수 | 안전/중위험/고위험 비중 |
| DASH-06 | 통화별 자산 | 🟡 권장 | KRW/USD 비중 |
| DASH-07 | 환율 표시 | 🔴 필수 | 현재 적용 환율 (USD/KRW) |

#### 4.1.6 환율/시세
| ID | 기능 | 우선순위 | 설명 |
|----|------|----------|------|
| RATE-01 | 환율 자동 갱신 | 🔴 필수 | 일 1회 GitHub Actions로 DB 갱신 |
| RATE-02 | 주가 조회 | 🔴 필수 | stock_master.base_price (전일 종가) |
| RATE-03 | 원화 환산 | 🔴 필수 | exchange_rates 테이블 기반 USD→KRW |

#### 4.1.7 설정
| ID | 기능 | 우선순위 | 설명 |
|----|------|----------|------|
| SET-01 | 프로필 수정 | 🟡 권장 | 이름 변경 |
| SET-02 | 기본 통화 설정 | 🟢 선택 | 대시보드 표시 통화 선택 |

---

### 4.2 2단계 (확장)

| ID | 기능 | 설명 |
|----|------|------|
| AUTH-06 | 이메일 OTP | 로그인 시 이메일로 인증 코드 발송 |
| AUTH-07 | 2FA (TOTP) | Google Authenticator 등 TOTP 앱 연동 |
| TAG-01 | 태그 관리 | 사용자 정의 태그 생성/수정/삭제 |
| TAG-02 | 자산에 태그 부착 | 자산별 태그 연결 |
| TARGET-01 | 목표 비중 설정 | 카테고리별 목표 % 설정 |
| TARGET-02 | 리밸런싱 가이드 | 목표 대비 현재 비중 비교, 조정 필요 금액 안내 |
| HISTORY-01 | 자산 변동 히스토리 | 월별 총자산 추이 그래프 |
| EXPORT-01 | 데이터 내보내기 | CSV/Excel 다운로드 |

### 4.3 3단계 (로드맵)

- 가계부 통합 (수입/지출 관리)
- 부동산/실물 자산 연동 (아파트 실거래가, 자동차 시세)
- 공동 목표 관리 ("5년 안에 5억 모으기" 등)
- 배당금 캘린더
- 알림 기능 (목표 달성, 리밸런싱 필요 시)

---

## 5. 사용자 플로우

### 5.1 온보딩 플로우

```
[최초 방문]
    ↓
[회원가입] → 이메일/비밀번호 입력
    ↓
[이메일 인증] → 인증 링크 클릭
    ↓
[가구 생성] → "우리집" 자동 생성, owner 역할 부여
    ↓
[파트너 초대 안내] → 초대 코드 생성 옵션
    ↓
[첫 자산 등록 유도]
    ↓
[대시보드]
```

### 5.2 파트너 초대 플로우

```
[사용자 A: 초대 코드 생성]
    ↓
[6자리 코드 발급] → 24시간 유효
    ↓
[사용자 B: 회원가입 또는 로그인]
    ↓
[초대 코드 입력]
    ↓
[가구 합류] → member 역할 부여
    ↓
[대시보드] → A와 B의 자산 통합 표시
```

### 5.3 거래 등록 플로우

```
[거래 추가 버튼]
    ↓
[거래 유형 선택] → 매수 / 매도
    ↓
[종목 검색] → 티커 또는 종목명 입력
    ↓
[종목 선택] → 종목 정보 확인 (현재가, 시장 등)
    ↓ (첫 거래 시 household_stock_settings에 자동 등록)
[상세 입력]
  - 수량
  - 거래 단가
  - 거래일
  - (선택) 메모
    ↓
[저장]
    ↓
[거래 내역에 추가] → holdings View 자동 갱신
```

### 5.4 종목 설정 수정 플로우

```
[설정 > 종목 설정]
    ↓
[종목 목록 확인] → 자산유형, 위험도 현황
    ↓
[종목 선택]
    ↓
[설정 수정]
  - 자산 유형 (주식/채권/현금 등)
  - 위험도 (안전/중위험/고위험)
    ↓
[저장]
    ↓
[대시보드 비중 차트에 반영]
```

### 5.5 일상 사용 플로우

```
[로그인] → 이메일/비밀번호
    ↓
[대시보드] 
  - 총 자산 확인
  - 수익률 확인
  - 비중 차트 확인
    ↓
[상세 확인 필요 시]
  - 보유 현황으로 이동
  - 개별 종목 상세 확인
    ↓
[변동 발생 시]
  - 추가 매수: 거래 등록 (매수)
  - 매도: 거래 등록 (매도)
```

---

## 6. 화면 정의

### 6.1 화면 목록

| 화면 | 경로 | 설명 |
|------|------|------|
| 랜딩 | `/` | 서비스 소개, 로그인/가입 유도 |
| 로그인 | `/login` | 이메일/비밀번호 |
| 회원가입 | `/signup` | 이메일/비밀번호 입력 |
| 대시보드 | `/dashboard` | 메인 화면, 통합 자산 현황 |
| 보유 현황 | `/holdings` | 현재 보유 종목 목록 |
| 거래 기록 | `/transactions` | 매수/매도 내역 |
| 거래 등록 | `/transactions/new` | 매수/매도 기록 폼 |
| 종목 설정 | `/settings/stocks` | 종목별 자산유형, 위험도 관리 |
| 설정 | `/settings` | 프로필, 가구 관리 |
| 파트너 초대 | `/settings/invite` | 초대 코드 생성/관리 |

### 6.2 대시보드 와이어프레임

```
┌─────────────────────────────────────────────────────────────┐
│  oat                                        [프로필] [설정]  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────┐  ┌─────────────────┐                  │
│  │    총 자산       │  │    총 수익률     │                  │
│  │  ₩125,430,000   │  │    +12.5%       │                  │
│  │  (↑₩2,340,000)  │  │    +₩15,678,000 │                  │
│  └─────────────────┘  └─────────────────┘                  │
│                                                             │
│  ┌─────────────────────────┐ ┌─────────────────────────┐   │
│  │     자산군별 비중        │ │     소유자별 자산        │   │
│  │      [파이차트]         │ │      [파이차트]          │   │
│  │  ● 주식 65%            │ │  ● 남편 55%             │   │
│  │  ● 채권 20%            │ │  ● 아내 45%             │   │
│  │  ● 현금 15%            │ │                         │   │
│  └─────────────────────────┘ └─────────────────────────┘   │
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │  위험도별 비중                                       │   │
│  │  [■■■■■■■■■■░░░░░]  안전 40%                        │   │
│  │  [■■■■■■■░░░░░░░░]  중위험 35%                      │   │
│  │  [■■■■░░░░░░░░░░░]  고위험 25%                      │   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  현재 환율: $1 = ₩1,320.50 (오늘 08:00 갱신)                 │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 6.3 보유 현황 와이어프레임

```
┌─────────────────────────────────────────────────────────────┐
│  보유 현황                                   [+ 거래 추가]  │
├─────────────────────────────────────────────────────────────┤
│  필터: [전체▼] [모든 유형▼] [모든 소유자▼]     검색: [____] │
├─────────────────────────────────────────────────────────────┤
│  종목       | 소유자 | 수량   | 평단가    | 현재가   | 수익률 │
│  ─────────────────────────────────────────────────────────  │
│  AAPL       | 남편   | 50    | $150.00  | $178.50 | +19.0% │
│  Apple Inc. |        |       |          |         |        │
│  ─────────────────────────────────────────────────────────  │
│  005930     | 아내   | 100   | ₩65,000  | ₩71,500 | +10.0% │
│  삼성전자    |        |       |          |         |        │
│  ─────────────────────────────────────────────────────────  │
│  GLD        | 남편   | 20    | $180.00  | $195.00 | +8.3%  │
│  SPDR Gold  |        |       |          |         |        │
└─────────────────────────────────────────────────────────────┘
```

---

## 7. 비기능 요구사항

### 7.1 성능

| 항목 | 목표 |
|------|------|
| 페이지 로드 | 3초 이내 (FCP) |
| API 응답 | 500ms 이내 |
| 대시보드 렌더링 | 1초 이내 |

### 7.2 보안

| 항목 | 요구사항 |
|------|----------|
| 인증 | 이메일/비밀번호 (OTP, 2FA는 2단계) |
| 데이터 접근 | RLS로 본인 가구 데이터만 접근 |
| 통신 | HTTPS 필수 |
| 세션 | 30일 유지, 비활성 7일 후 만료 |

### 7.3 접근성

| 항목 | 요구사항 |
|------|----------|
| 반응형 | PC/태블릿/모바일 지원 |
| PWA | 앱 설치, 오프라인 기본 화면 |
| 키보드 | 주요 기능 키보드 접근 가능 |

### 7.4 확장성

| 항목 | 요구사항 |
|------|----------|
| 가구 인원 | 초기 2명, 향후 10명까지 확장 고려 |
| 자산 개수 | 가구당 최대 500개 자산 |

---

## 8. 성공 지표

### 8.1 MVP 성공 기준

| 지표 | 목표 |
|------|------|
| 부부 계정 연동 완료 | 본인 가구 100% |
| 자산 등록 | 보유 종목 80% 이상 등록 |
| 주간 접속 | 최소 2회 이상 |
| 데이터 정확도 | 실제 자산 대비 오차 5% 이내 |

### 8.2 장기 지표 (참고)

| 지표 | 목표 |
|------|------|
| MAU | 1,000 가구 |
| 가구당 평균 자산 수 | 15개 |
| NPS | 50 이상 |

---

## 9. 제약 사항

### 9.1 기술적 제약

| 항목 | 제약 |
|------|------|
| 주가 데이터 | KIS 마스터파일 (전일 종가만, 실시간 없음) |
| 환율 | ExchangeRate-API 무료 (일 1회 갱신) |
| 한국 종목 | 코스피/코스닥만 지원 (코넥스 제외) |
| 해외 종목 | NYSE/NASDAQ/AMEX만 지원 |

### 9.2 비즈니스 제약

| 항목 | 제약 |
|------|------|
| 증권사 연동 | 불가 (오픈뱅킹 미지원) |
| 자동 매매 | 불가 (정보 제공만) |

---

## 10. 릴리즈 계획

### 10.1 MVP (v1.0)

**예상 기간**: 8-10주

| 주차 | 마일스톤 |
|------|----------|
| 1-2 | 프로젝트 셋업, DB 구축, 인증 |
| 3-4 | 가구 관리, 초대 기능 |
| 5-6 | 자산 CRUD, 종목 검색/조회 |
| 7-8 | 대시보드, 차트 |
| 9-10 | PWA, 테스트, 배포 |

### 10.2 v1.1 (2단계)

- 태그 기능
- 목표 비중 & 리밸런싱
- 자산 변동 히스토리